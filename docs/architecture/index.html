<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-architecture">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Architecture | vVCU-as-CNF</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://vvcu-as-cnf.github.io/website/docs/architecture"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture | vVCU-as-CNF"><meta data-rh="true" name="description" content="Components"><meta data-rh="true" property="og:description" content="Components"><link data-rh="true" rel="icon" href="/website/img/logo.ico"><link data-rh="true" rel="canonical" href="https://vvcu-as-cnf.github.io/website/docs/architecture"><link data-rh="true" rel="alternate" href="https://vvcu-as-cnf.github.io/website/docs/architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://vvcu-as-cnf.github.io/website/docs/architecture" hreflang="x-default"><link rel="stylesheet" href="/website/assets/css/styles.23b16253.css">
<link rel="preload" href="/website/assets/js/runtime~main.9541d0c7.js" as="script">
<link rel="preload" href="/website/assets/js/main.9142eafd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/website/"><div class="navbar__logo"><img src="/website/img/logo.ico" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/website/img/logo.ico" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">vVCU-as-CNF</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/website/docs/documentation">Documentation</a><a class="navbar__item navbar__link" href="/website/references/glossary">References</a></div><div class="navbar__items navbar__items--right"><a href="http://vvcu-as-a-cnf.av.it.pt/d/a95b957e-022b-44c8-a706-79ddd2acd931/main-dashboard?orgId=1" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">System Dashboard</a><a href="http://vvcu-as-a-cnf.av.it.pt/d/dbd697ba-c1ff-41ab-8773-4c98f98de26f/manager-dashboard?orgId=1" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Digital Twin Dashboard</a><a href="https://github.com/vVCU-as-CNF" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/website/docs/documentation">Project Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/website/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/website/docs/report">Project Report</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/website/docs/videos">Promo &amp; Demo Videos</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/website/docs/category/milestones">Milestones</a><button aria-label="Toggle the collapsible sidebar category &#x27;Milestones&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Architecture</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Architecture</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components">​</a></h2><p>Our architecture has 6 main components, as shown in Figure 7: the VCUs (both the OBUs and RSUs), the message brokers, the orchestrator, the MECs, the manager and the Grafana dashboards.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="obus-and-rsus">OBUs and RSUs<a href="#obus-and-rsus" class="hash-link" aria-label="Direct link to OBUs and RSUs" title="Direct link to OBUs and RSUs">​</a></h3><p>The OBUs and RSUs are the physical components that we are creating a DT for. They generate data continuously and publish it to a network of message brokers. </p><p>For each of these objects, we instantiate its corresponding digital twin, which gathers all the information regarding its object and forwards it to our user-interface. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-messaging-network">The Messaging Network<a href="#the-messaging-network" class="hash-link" aria-label="Direct link to The Messaging Network" title="Direct link to The Messaging Network">​</a></h3><p>The messages in the network are organized by topics, relating both to the sender’s identity and geographic location, and each DT fetches their respective data from them. This includes both data related to its physical counterpart and the surrounding stations to enable cooperation.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="orchestrator">Orchestrator<a href="#orchestrator" class="hash-link" aria-label="Direct link to Orchestrator" title="Direct link to Orchestrator">​</a></h3><p>The orchestrator is the component that handles the lifecycle of the digital twins. It orchestrates their deployment and management and the resources needed to run these, like network connectivity and virtual machines.  </p><p>This orchestrator would consist of a MANO software. MANO is an architectural framework that can coordinate the deployment of cloud-based applications.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mecs">MECs<a href="#mecs" class="hash-link" aria-label="Direct link to MECs" title="Direct link to MECs">​</a></h3><p>The MEC nodes are the hosts for the DTs. These computing nodes are located at the edge of the network, thus allowing for the deployment and execution of the service closer to the devices. </p><p>Due to the nature of a CNF, all stages of the DT’s lifecycle take place in these nodes, from instantiation to deletion. The orchestrator communicates directly with the MECs when it needs to create or delete a digital twin.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manager">Manager<a href="#manager" class="hash-link" aria-label="Direct link to Manager" title="Direct link to Manager">​</a></h3><p>The manager is our trigger event listener component. It orchestrates the migration process, is responsible for listening for migrating triggers and handling the subsequent migration logic, as well as supporting Grafana by providing some real-time data, such as the DT location in the system.  </p><p>It is the manager who communicates directly with the Orchestrator and controls when a migration should occur or not. The trigger for a migration is based on the physical location of the OBU and it is automated. However, an API was implemented, that provides a collection of endpoints that allow us to execute operations, such as starting a migration process on a DT, but also provides relevant information to the Data Visualization Dashboard. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-dashboards">Grafana Dashboards<a href="#grafana-dashboards" class="hash-link" aria-label="Direct link to Grafana Dashboards" title="Direct link to Grafana Dashboards">​</a></h3><p>Two data dashboards are deployed on the same machine that the manager is on. These consume data from the message network and display it in a user-friendly interface. </p><p>Important to note a small but relevant component adjacent to this dashboard, which is the proxy, an intermediary in communications that transforms some of the values before sending them to the user-friendly-interface. </p><br><div style="text-align:center"><img loading="lazy" src="https://media.discordapp.net/attachments/1079089453198479370/1112856037612069016/general_architecture.drawio.png" style="max-width:80%" class="img_ev3q"><p>Image 1 - Component-Based Architecture</p></div><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="technologies">Technologies<a href="#technologies" class="hash-link" aria-label="Direct link to Technologies" title="Direct link to Technologies">​</a></h2><p>In this section, we describe the purposes and the reasons behind the choices of the technologies used to develop this project. Besides that, there is a brief preview of the advantages of using such technologies.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker">Docker<a href="#docker" class="hash-link" aria-label="Direct link to Docker" title="Direct link to Docker">​</a></h3><p>In the beginning of this project, we were provided with a Docker image which contained the code, dependencies and configuration of a digital twin application. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mosquitto">Mosquitto<a href="#mosquitto" class="hash-link" aria-label="Direct link to Mosquitto" title="Direct link to Mosquitto">​</a></h3><p>This digital twin was consuming from a topic of a message broker that was set up using Mosquitto, an open-source message broker, and was consuming the messages the OBU was publishing on said topic. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes">Kubernetes<a href="#kubernetes" class="hash-link" aria-label="Direct link to Kubernetes" title="Direct link to Kubernetes">​</a></h3><p>One of the goals of the project is to offer digital twins through CNFs. This CNF would be instantiated in a MEC. As mentioned in the architecture section, we did not use real MEC and instead simulated its existence with two Kubernetes clusters, each in separate machines. The DTs will be deployed in these. However, we cannot just deploy a Docker image in a Kubernetes cluster. We had to create a Kubernetes application which contained not only our digital twin docker image, but also all the components necessary to integrate it in a Kubernetes cluster environment. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="helm">Helm<a href="#helm" class="hash-link" aria-label="Direct link to Helm" title="Direct link to Helm">​</a></h3><p>To do this we used Helm, which is a package manager for Kubernetes applications. Helm allows us to define our Kubernetes application in a Helm Chart. This Helm Chart contains the files which define the structure, configuration and deployment of our Kubernetes application and it is hand and since OSM can handle Helm Charts, we encapsulated our Digital Twins Kubernetes application in a Helm Chart, and we provided it to OSM so that it can manage the application deployments in the different clusters. With this process completed, we were able to launch our CNF.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="open-source-mano">Open Source MANO<a href="#open-source-mano" class="hash-link" aria-label="Direct link to Open Source MANO" title="Direct link to Open Source MANO">​</a></h3><p>It is important to highlight that in our solution, the number of digital twins deployed in a cluster is subject to change, according to real-world changes. Not only that, but our solution must also handle the creation and deployment of a digital twin at any given time without any negative impact and this process needs to be automated and not need any human intervention. For this to happen we need our orchestrator. </p><p>With that being said, we chose Open-Source MANO as our orchestrator, given that it can manage the different Kubernetes applications inside each cluster. For this to occur, we describe how our Kubernetes application should look like to OSM to allow it to orchestrate and manage it properly.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="grafana">Grafana<a href="#grafana" class="hash-link" aria-label="Direct link to Grafana" title="Direct link to Grafana">​</a></h3><p>Now that our solution supports the migration of the Digital Twins among clusters, we still need an interface that allows the user to see not only the Digital Twin information, but also the migration process happening. So, we deployed a message broker, also using Mosquitto, and made all Digital Twins publish their messages to a topic in this broker. This broker was deployed in the same virtual machine where a container running a Grafana Instance was deployed and displaying the different Digital Twins information. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fastapi">FastAPI<a href="#fastapi" class="hash-link" aria-label="Direct link to FastAPI" title="Direct link to FastAPI">​</a></h3><p>Our solution must also handle the migration of a Digital Twin from one cluster to another. This process is accomplished by terminating a Kubernetes application from one cluster and creating it in another cluster. However, it is important to note that this implementation is only possible because our system is stateless, meaning its operations do not rely on any stored data and different applications can be created and terminated without any negative impact in the overall system. </p><p>So, to handle the migration we had to implement a component that integrated an API which would then be used to communicate to OSM when a migration needed to occur. To implement this API we used FastAPI, a python framework that allows us to create APIs in a very quick and simple manner. This way, we can create an endpoint we can call that handles the logic adjacent to the migration process. </p><br><div style="text-align:center"><img loading="lazy" src="https://media.discordapp.net/attachments/1079089453198479370/1112845350919733299/techs_architecture.png?width=1080&amp;height=516" style="max-width:80%" class="img_ev3q"><p>Image 2 - High-Level System Architecture</p></div><br><p>For more information, <a href="/website/docs/report">read</a> the project specification report.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/website/docs/documentation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Project Guidelines</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/website/docs/report"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Project Report</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#components" class="table-of-contents__link toc-highlight">Components</a><ul><li><a href="#obus-and-rsus" class="table-of-contents__link toc-highlight">OBUs and RSUs</a></li><li><a href="#the-messaging-network" class="table-of-contents__link toc-highlight">The Messaging Network</a></li><li><a href="#orchestrator" class="table-of-contents__link toc-highlight">Orchestrator</a></li><li><a href="#mecs" class="table-of-contents__link toc-highlight">MECs</a></li><li><a href="#manager" class="table-of-contents__link toc-highlight">Manager</a></li><li><a href="#grafana-dashboards" class="table-of-contents__link toc-highlight">Grafana Dashboards</a></li></ul></li><li><a href="#technologies" class="table-of-contents__link toc-highlight">Technologies</a><ul><li><a href="#docker" class="table-of-contents__link toc-highlight">Docker</a></li><li><a href="#mosquitto" class="table-of-contents__link toc-highlight">Mosquitto</a></li><li><a href="#kubernetes" class="table-of-contents__link toc-highlight">Kubernetes</a></li><li><a href="#helm" class="table-of-contents__link toc-highlight">Helm</a></li><li><a href="#open-source-mano" class="table-of-contents__link toc-highlight">Open Source MANO</a></li><li><a href="#grafana" class="table-of-contents__link toc-highlight">Grafana</a></li><li><a href="#fastapi" class="table-of-contents__link toc-highlight">FastAPI</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/website/assets/js/runtime~main.9541d0c7.js"></script>
<script src="/website/assets/js/main.9142eafd.js"></script>
</body>
</html>